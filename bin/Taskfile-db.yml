version: "3"

tasks:
  start-mongo:
    cmds:
      - echo "Starting MongoDB..."
      - docker run --name mongo -d -p 27017:27017 mongo:{{.MONGO_VERSION}}

  start-redis-single:
    cmds:
      - echo "Starting Redis single instance..."
      - docker run --name redis-single -d -p 6379:6379 redis:{{.REDIS_VERSION}}

  start-redis-cluster:
    cmds:
      - echo "Starting Redis Cluster..."
      - REDIS_VERSION={{.REDIS_VERSION}} docker-compose up --detach
      - docker exec -it bin-redis-node-0-1 redis-cli --cluster fix localhost:6379
      - docker exec -it bin-redis-node-1-1 redis-cli --cluster fix localhost:6379
      - docker exec -it bin-redis-node-2-1 redis-cli --cluster fix localhost:6379
      - docker exec -it bin-redis-node-3-1 redis-cli --cluster fix localhost:6379
      - docker exec -it bin-redis-node-4-1 redis-cli --cluster fix localhost:6379
      - docker exec -it bin-redis-node-5-1 redis-cli --cluster fix localhost:6379
